# Конфигурация платы микроконтроллера (board.json)

## Описание

Файл `board.json` содержит основную информацию о микроконтроллере, его портах, регистрах и ссылки на другие конфигурационные файлы. Этот файл является точкой входа для загрузки конфигурации платы.

## Структура файла

### Основные поля

```json
{
  "main": {
    "id": "ATMEGA328P",        // Уникальный идентификатор микроконтроллера
    "name": "ATmega328P",       // Человекочитаемое название
    "frequency": 16000000       // Частота тактирования в Гц
  },
  "ports": [...],              // Массив портов ввода/вывода
  "image": "...",              // Путь к изображению платы
  "files": {...}               // Ссылки на другие конфигурационные файлы
}
```

## Структура секции main

### Поля main

```json
{
  "id": "ATMEGA328P",          // Уникальный идентификатор (обычно в верхнем регистре)
  "name": "ATmega328P",        // Полное название микроконтроллера
  "frequency": 16000000        // Рабочая частота в герцах (Hz)
}
```

## Структура порта (ports)

### Поля порта

```json
{
  "id": "B",                   // Буквенный идентификатор порта (A, B, C, D...)
  "name": "PORTB",             // Имя регистра порта (PORTB, PORTC, PORTD...)
  "pins": [0, 1, 2, 3, 4, 5],  // Массив номеров пинов в порту (0-15)
  "registers": {
    "ddr": "DDRB",             // Имя регистра направления данных (DDRx)
    "port": "PORTB",           // Имя регистра порта вывода (PORTx)
    "pin": "PINB"              // Имя регистра порта ввода (PINx)
  }
}
```

### Регистры порта

- **ddr** (Data Direction Register) - регистр направления данных. Определяет, является ли пин входом (0) или выходом (1).
- **port** (PORT Register) - регистр порта вывода. Используется для установки уровня на выходе или включения подтягивающего резистора на входе.
- **pin** (PIN Register) - регистр порта ввода. Используется для чтения состояния пина.

## Структура секции files

### Поля files

```json
{
  "pins": "pins.json",              // Файл конфигурации пинов
  "peripheries": "peripheries.json", // Файл конфигурации периферий
  "constraints": "constraints.json", // Файл ограничений и конфликтов
  "codegen": "codegen.json"         // Файл шаблонов генерации кода
}
```

Все пути указываются относительно директории конфигурации платы.

## Примеры использования

### Пример 1: Полная конфигурация ATmega328P

```json
{
  "main": {
    "id": "ATMEGA328P",
    "name": "ATmega328P",
    "frequency": 16000000
  },
  "ports": [
    {
      "id": "B",
      "name": "PORTB",
      "pins": [0, 1, 2, 3, 4, 5],
      "registers": {
        "ddr": "DDRB",
        "port": "PORTB",
        "pin": "PINB"
      }
    },
    {
      "id": "C",
      "name": "PORTC",
      "pins": [0, 1, 2, 3, 4, 5],
      "registers": {
        "ddr": "DDRC",
        "port": "PORTC",
        "pin": "PINC"
      }
    },
    {
      "id": "D",
      "name": "PORTD",
      "pins": [0, 1, 2, 3, 4, 5, 6, 7],
      "registers": {
        "ddr": "DDRD",
        "port": "PORTD",
        "pin": "PIND"
      }
    }
  ],
  "image": "/src/config/atmega328p/image.png",
  "files": {
    "pins": "pins.json",
    "peripheries": "peripheries.json",
    "constraints": "constraints.json",
    "codegen": "codegen.json"
  }
}
```

## Примечания

- Поле `frequency` используется для расчёта делителей частоты и таймаутов в периферийных устройствах.
- Массив `pins` в порте указывает только на физически существующие пины. Некоторые порты могут иметь не все пины (например, PORTC в ATmega328P имеет только 6 пинов).
- Имена регистров должны соответствовать макроопределениям в заголовочных файлах компилятора (например, `avr/io.h` для AVR).

