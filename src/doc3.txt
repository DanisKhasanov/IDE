–ü—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –Ω–∞ ATmega328P (Arduino Uno)
–ü—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –ø–æ–∑–≤–æ–ª—è—é—Ç –º–∏–∫—Ä–æ–∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—É —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å–æ–±—ã—Ç–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑–º–µ–Ω–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –ø–∏–Ω–∞, –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ –ø–µ—Ä–µ–¥–∞—á–∏ –ø–æ SPI, –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞) –≤–Ω–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Ü–∏–∫–ª–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã (loop()). –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–æ–¥ –±–æ–ª–µ–µ –æ—Ç–∑—ã–≤—á–∏–≤—ã–º –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º.

1. –í–Ω–µ—à–Ω–∏–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è (External Interrupts)
–≠—Ç–∏ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è —Ä–µ–∞–≥–∏—Ä—É—é—Ç –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è, –æ–±—ã—á–Ω–æ –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –ø–∏–Ω–∞—Ö.
‚óè –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ: 2 (INT0, INT1)
‚óè –ü–∏–Ω—ã: PD2 (INT0), PD3 (INT1)
‚óè –£—Å–ª–æ–≤–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è: LOW, CHANGE, RISING, FALLING
‚óè –†–µ–≥–∏—Å—Ç—Ä—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
o EICRA (External Interrupt Control Register A): ISC01, ISC00 (INT0), ISC11, ISC10 (INT1)
o EIMSK (External Interrupt Mask Register): INT0, INT1 ‚Äî –≤–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ.
o EIFR (External Interrupt Flag Register): INTF0, INTF1 ‚Äî —Ñ–ª–∞–≥–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ ISR).
‚óè –í–µ–∫—Ç–æ—Ä—ã –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π:
o INT0_vect
o INT1_vect
üìÑ –ü—Ä–∏–º–µ—Ä:

void external_interrupt_init() {
    EICRA |= (1 << ISC01); // FALLING edge –Ω–∞ INT0 (PD2)
    EIMSK |= (1 << INT0);  // –í–∫–ª—é—á–∏—Ç—å INT0
    sei(); // Enable global interrupts
}

ISR(INT0_vect) {
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –æ—Ç PD2
}

2. –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏—è —Å–º–µ–Ω—ã —É—Ä–æ–≤–Ω—è (Pin Change Interrupts - PCINT)
–≠—Ç–∏ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –º–æ–≥—É—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –Ω–∞ –ª—é–±–æ–º –ø–∏–Ω–µ, –Ω–æ –≥—Ä—É–ø–ø–∏—Ä—É—é—Ç—Å—è –ø–æ –ø–æ—Ä—Ç–∞–º.
‚óè –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥—Ä—É–ø–ø: 3 (PCINT0-7 –¥–ª—è PORTB, PCINT8-13 –¥–ª—è PORTC, PCINT16-23 –¥–ª—è PORTD)
‚óè –ü–∏–Ω—ã: –í—Å–µ –ø–∏–Ω—ã (PB0-PB5, PC0-PC5, PD0-PD7)
‚óè –£—Å–ª–æ–≤–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è: –ò–∑–º–µ–Ω–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è (HIGH -> LOW –∏–ª–∏ LOW -> HIGH) –Ω–∞ –ª—é–±–æ–º –ø–∏–Ω–µ –≤ –≥—Ä—É–ø–ø–µ.
‚óè –†–µ–≥–∏—Å—Ç—Ä—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
o PCICR (Pin Change Interrupt Control Register): PCIE0 (PORTB), PCIE1 (PORTC), PCIE2 (PORTD) ‚Äî –≤–∫–ª—é—á–∏—Ç—å –≥—Ä—É–ø–ø—É.
o PCMSK0, PCMSK1, PCMSK2 (Pin Change Mask Registers): –í—ã–±—Ä–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø–∏–Ω—ã –≤ –≥—Ä—É–ø–ø–µ.
o PCIFR (Pin Change Interrupt Flag Register): PCIF0, PCIF1, PCIF2 ‚Äî —Ñ–ª–∞–≥–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è –ø—Ä–∏ –≤—Ö–æ–¥–µ –≤ ISR).
‚óè –í–µ–∫—Ç–æ—Ä—ã –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π:
o PCINT0_vect (PORTB)
o PCINT1_vect (PORTC)
o PCINT2_vect (PORTD)
–í–∞–∂–Ω–æ: –í–Ω—É—Ç—Ä–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ (ISR) –Ω—É–∂–Ω–æ —Å–∞–º–æ–º—É –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, –∫–∞–∫–æ–π –∏–º–µ–Ω–Ω–æ –ø–∏–Ω –∏–∑–º–µ–Ω–∏–ª —Å–æ—Å—Ç–æ—è–Ω–∏–µ, —Å—Ä–∞–≤–Ω–∏–≤ —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ PINB, PINC, PIND —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –∑–Ω–∞—á–µ–Ω–∏–µ–º.
–ü—Ä–∏–º–µ—Ä:

void pin_change_interrupt_init() {
    PCICR |= (1 << PCIE2);   // –í–∫–ª—é—á–∏—Ç—å PCINT16-23 (PORTD)
    PCMSK2 |= (1 << PCINT18); // –í–∫–ª—é—á–∏—Ç—å PCINT18 (PD2)
    sei();
}

ISR(PCINT2_vect) {
    // –ù—É–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –∫–∞–∫–æ–π –ø–∏–Ω –∏–∑–º–µ–Ω–∏–ª—Å—è
    static uint8_t last_port_d = PIND;
    uint8_t current_port_d = PIND;
    uint8_t changed_pins = last_port_d ^ current_port_d;

    if (changed_pins & (1 << PIND2)) {
        // PD2 –∏–∑–º–µ–Ω–∏–ª—Å—è
    }

    last_port_d = current_port_d;
}

3. –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –æ—Ç –ø–µ—Ä–∏—Ñ–µ—Ä–∏–∏
–ú–Ω–æ–≥–∏–µ –º–æ–¥—É–ª–∏ –ø–µ—Ä–∏—Ñ–µ—Ä–∏–∏ –º–æ–≥—É—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –ø—Ä–∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö.
üîπ UART (USART0)
‚óè –°–æ–±—ã—Ç–∏—è:
o USART_RX_vect: –ü—Ä–∏—ë–º –±–∞–π—Ç–∞ –∑–∞–≤–µ—Ä—à—ë–Ω (UDR0 –∑–∞–ø–æ–ª–Ω–µ–Ω).
o USART_TX_vect: –ü–µ—Ä–µ–¥–∞—á–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ (UDR0 –ø—É—Å—Ç, –Ω–æ –Ω–µ Data Register Empty).
o USART_UDRE_vect: –†–µ–≥–∏—Å—Ç—Ä –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç (–º–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å –≤ UDR0).
‚óè –†–µ–≥–∏—Å—Ç—Ä—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
o UCSR0B: RXCIE0 (RX Complete), TXCIE0 (TX Complete), UDRIE0 (Data Register Empty).
üîπ SPI
‚óè –°–æ–±—ã—Ç–∏–µ:
o SPI_STC_vect: –ó–∞–≤–µ—Ä—à–µ–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞/–ø—Ä–∏—ë–º –±–∞–π—Ç–∞ (SPIF –≤ SPSR).
‚óè –†–µ–≥–∏—Å—Ç—Ä—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
o SPCR: SPIE ‚Äî –≤–∫–ª—é—á–∏—Ç—å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ.
üîπ –¢–∞–π–º–µ—Ä—ã/–°—á—ë—Ç—á–∏–∫–∏
‚óè –¢–∞–π–º–µ—Ä0:
o TIMER0_OVF_vect: –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ (TCNT0 —Å—Ç–∞–ª 0xFF -> 0x00).
o TIMER0_COMPA_vect: –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å OCR0A.
o TIMER0_COMPB_vect: –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å OCR0B.
‚óè –¢–∞–π–º–µ—Ä1:
o TIMER1_OVF_vect: –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ.
o TIMER1_COMPA_vect: –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å OCR1A.
o TIMER1_COMPB_vect: –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å OCR1B.
o TIMER1_CAPT_vect: –ó–∞—Ö–≤–∞—Ç (—Ç–æ–ª—å–∫–æ –≤ —Ä–µ–∂–∏–º–µ Input Capture, ICF1 –≤ TIFR1).
‚óè –¢–∞–π–º–µ—Ä2:
o TIMER2_OVF_vect: –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ.
o TIMER2_COMPA_vect: –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å OCR2A.
o TIMER2_COMPB_vect: –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å OCR2B.
üîπ ADC
‚óè –°–æ–±—ã—Ç–∏–µ:
o ADC_vect: –ó–∞–≤–µ—Ä—à–µ–Ω–æ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ (ADIF –≤ ADCSRA).
‚óè –†–µ–≥–∏—Å—Ç—Ä—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
o ADCSRA: ADIE ‚Äî –≤–∫–ª—é—á–∏—Ç—å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ.
üîπ –ê–Ω–∞–ª–æ–≥–æ–≤—ã–π –∫–æ–º–ø–∞—Ä–∞—Ç–æ—Ä
‚óè –°–æ–±—ã—Ç–∏–µ:
o ANALOG_COMP_vect: –†–µ–∑—É–ª—å—Ç–∞—Ç –∫–æ–º–ø–∞—Ä–∞—Ç–æ—Ä–∞ –∏–∑–º–µ–Ω–∏–ª—Å—è (ACI –≤ ACSR).
‚óè –†–µ–≥–∏—Å—Ç—Ä—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
o ACSR: ACIE ‚Äî –≤–∫–ª—é—á–∏—Ç—å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ.

4. –ü—Ä–µ—Ä—ã–≤–∞–Ω–∏—è –æ—Ç Watchdog Timer (WDT)
‚óè –°–æ–±—ã—Ç–∏–µ:
o WDT_vect: –¢–∞–π–º–µ—Ä —Å—Ä–∞–±–æ—Ç–∞–ª (–µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ, –∞ –Ω–µ –ø—Ä–æ—Å—Ç–æ —Å–±—Ä–æ—Å).
‚óè –†–µ–≥–∏—Å—Ç—Ä—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
o WDTCSR: WDIE ‚Äî –≤–∫–ª—é—á–∏—Ç—å –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ (–≤–º–µ—Å—Ç–æ WDE –¥–ª—è —Å–±—Ä–æ—Å–∞).
–í–∫–ª—é—á–µ–Ω–∏–µ –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π
‚óè sei(); ‚Äî Set Enable Interrupts ‚Äî –≤–∫–ª—é—á–∞–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è.
‚óè cli(); ‚Äî Clear Interrupts ‚Äî –≤—ã–∫–ª—é—á–∞–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è (–Ω–∞ –≤—Ä–µ–º—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—á–∞—Å—Ç–∫–æ–≤ –∫–æ–¥–∞).

üìù –í—ã–≤–æ–¥
–í–æ—Ç –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –≤–µ–∫—Ç–æ—Ä–æ–≤ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–π –¥–ª—è ATmega328P:
| –í–µ–∫—Ç–æ—Ä –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è          | –ò—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è               | –û–ø–∏—Å–∞–Ω–∏–µ / –ü–æ—Ä—Ç                          |
|-----------------------------|------------------------------------|------------------------------------------|
| `INT0_vect`                 | External Interrupt Request 0       | PD2                                      |
| `INT1_vect`                 | External Interrupt Request 1       | PD3                                      |
| `PCINT0_vect`               | Pin Change Interrupt Request 0     | PORTB (PB0‚ÄìPB5)                          |
| `PCINT1_vect`               | Pin Change Interrupt Request 1     | PORTC (PC0‚ÄìPC5)                          |
| `PCINT2_vect`               | Pin Change Interrupt Request 2     | PORTD (PD0‚ÄìPD7)                          |
| `WDT_vect`                  | Watchdog Time-Out Interrupt        | Watchdog Timer                           |
| `TIMER2_COMPA_vect`         | Timer/Counter2 Compare Match A     | Timer2 OCR2A                             |
| `TIMER2_COMPB_vect`         | Timer/Counter2 Compare Match B     | Timer2 OCR2B                             |
| `TIMER2_OVF_vect`           | Timer/Counter2 Overflow            | Timer2                                   |
| `TIMER1_CAPT_vect`          | Timer/Counter1 Capture Event       | Timer1 ICR1                              |
| `TIMER1_COMPA_vect`         | Timer/Counter1 Compare Match A     | Timer1 OCR1A                             |
| `TIMER1_COMPB_vect`         | Timer/Counter1 Compare Match B     | Timer1 OCR1B                             |
| `TIMER1_OVF_vect`           | Timer/Counter1 Overflow            | Timer1                                   |
| `TIMER0_COMPA_vect`         | Timer/Counter0 Compare Match A     | Timer0 OCR0A                             |
| `TIMER0_COMPB_vect`         | Timer/Counter0 Compare Match B     | Timer0 OCR0B                             |
| `TIMER0_OVF_vect`           | Timer/Counter0 Overflow            | Timer0                                   |
| `SPI_STC_vect`              | SPI Serial Transfer Complete       | SPI                                      |
| `USART_RX_vect`             | USART Rx Complete                  | UART0                                    |
| `USART_UDRE_vect`           | USART Data Register Empty          | UART0                                    |
| `USART_TX_vect`             | USART Tx Complete                  | UART0                                    |
| `ADC_vect`                  | ADC Conversion Complete            | ADC                                      |
| `ANALOG_COMP_vect`          | Analog Comparator                  | Analog Comparator                        |
| `TWI_vect`                  | 2-wire Serial Interface            | TWI (I2C) ‚Äì *–Ω–µ –Ω–∞ ATmega328P*           |
| `SPM_RDY_vect`              | Store Program Memory Ready         | SPM                                      |


–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: TWI_vect –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ ATmega328P, —Ö–æ—Ç—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç –≤ –≤–µ–∫—Ç–æ—Ä–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ. TWI (I2C) —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —á–µ—Ä–µ–∑ TWBR, TWSR, TWDR, TWCR, –Ω–æ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏–µ TWI_vect –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º Arduino —è–¥—Ä–µ.
